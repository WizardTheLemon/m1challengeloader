<?xml version="1.0" encoding="utf-8" ?>
<Scene>
	<!-- AUTHOR:   Dan Eriksson @ Pieces Interactive, 2012 -->

  <model>ch_woot_bout_of_madness</model>
  <reverb roomType="10" mix="40" />
  <killplaneposition>-35</killplaneposition>
  
  <trigger id="Start" repeat="false">
    <if />
    <then>
      <cameramagnify magnification="0.8"/>
      <playMusic cue="music_wizardcastle" delay="3.5" />
      <playSound id="ambient_audience" volume="0" cue="Additionalmusic/woot_amb_audience_hum" />

      <playSound volume="0" cue="Additional/woot_short_fanfare" delay="1" />

      <!--<playAnimation name="holes" loop="true" />-->

      <executeTrigger trigger="hole_detectors_init" />

      <executeTrigger trigger="confettiOfMisfortune_cycle" delay="0.5" />

      <!--<playAnimation name="rope1" loop="true"/>
      <playAnimation name="rope2" loop="true"/>
      <playAnimation name="rope3" loop="true"/>
      <playAnimation name="rope4" loop="true"/>-->

      <!--<playSound id="ch_arena_bars01" volume="0" area="ch_arena_bars01" radius="150" apply3d="true" cue="Misc/misc_arena_gate01" />-->
    </then>
  </trigger>

  <RuleSet type="Survival" waves="20">
    <spawnAreas>
      <area>north</area>
      <area>west</area>
      <area>east</area>
      <area>south</area>
    </spawnAreas>
  </RuleSet>
  
  <!-- Initialization script for Hole Detectors
       The hole system should not function unless this script is called
  -->
  <trigger id="hole_detectors_init" repeat="false" autorun="false">
    <if />
    <then>
      <!-- These count how many units have fallen into a hole. -->
      <counter name="hole1_counter" action="set" value="0" />
      <counter name="hole2_counter" action="set" value="0" />
      <counter name="hole3_counter" action="set" value="0" />
      <counter name="hole4_counter" action="set" value="0" />

      <!-- Unless these are 1 from start, the holes system will not run.
          Also, these are automatically set to 0 when a hole closes and then 1 again when they reopen. -->
      <counter name="hole1_detector_active" action="set" value="1" />
      <counter name="hole2_detector_active" action="set" value="1" />
      <counter name="hole3_detector_active" action="set" value="1" />
      <counter name="hole4_detector_active" action="set" value="1" />

      <counter name="holes_closed_counter" action="set" value="0" />
      


      <!--<playAnimation name="holes" loop="true" />-->

    </then>
  </trigger>
  
  <!-- Hole close bonus spawn script, called when a hole closes
  -->
  <trigger id="holes_shared_spawn_bonus" repeat="true" autorun="false">
    <if />
    <then>
      <!-- Every time a hole closes, the reward is different, until
          8 holes have been closed upon which the last reward repeats.
          This should be a "cheer buff" for all players. -->
      
      <!-- Each reward tier, except the final one, should consist of
           1 Magick and 1 Item of suitable kinds. The next to last
           should yield the magick SummonUndead, making it a lot
           easier to fill holes. -->
      
      <!-- TODO: Graphical effects for spawning in the middle. -->
      <executeTrigger trigger="holes_countCheck_1" />
      <executeTrigger trigger="holes_countCheck_2" />
      <executeTrigger trigger="holes_countCheck_3" />
      <executeTrigger trigger="holes_countCheck_4" />
      <executeTrigger trigger="holes_countCheck_5" />
      <executeTrigger trigger="holes_countCheck_6" />
      <executeTrigger trigger="holes_countCheck_7" />
      <executeTrigger trigger="holes_countCheck_8" />
    </then>
  </trigger>
  
  <!-- Scripts for spawning hole bonuses/rewards
      Checks to see how many holes have been closed and spawn a reward based on this count -->
  <trigger id="holes_countCheck_1" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="1" />
    </if>
    <then>
      <spawnMagick magick="haste" area="bonus_trigger1" immovable="false" />
      <spawnItem item="staff_emergency_teleport_rod" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger1" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_2" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="2" />
    </if>
    <then>
      <spawnMagick magick="performanceenchantment" area="bonus_trigger1" immovable="false" />
      <spawnItem item="weapon_woot_humidity_dispenser" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger2" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_3" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="3" />
    </if>
    <then>
      <spawnMagick magick="teleport" area="bonus_trigger1" immovable="false" />
      <spawneffect name="bonus_book_trigger1" area="bonus_trigger1" effect="special_woot_itemspawn"/>
      <spawnItem item="weapon_woot_pelota_magtecka" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger3" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_4" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="4" />
    </if>
    <then>
      <spawnMagick magick="wave" area="bonus_trigger1" immovable="false" />
      <spawneffect name="bonus_book_trigger2" area="bonus_trigger1" effect="special_woot_itemspawn"/>
      <spawnItem item="staff_woot_north_vault_pole" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger4" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_5" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="5" />
    </if>
    <then>
      <spawnMagick magick="conflagration" area="bonus_trigger1" immovable="false" />
      <spawneffect name="bonus_book_trigger3" area="bonus_trigger1" effect="special_woot_itemspawn"/>
      <spawnItem item="weapon_woot_zcovilleus_junior" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger5" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_6" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="6" />
    </if>
    <then>
      <spawnMagick magick="judgementspray" area="bonus_trigger1" immovable="false" />
      <spawneffect name="bonus_book_trigger4" area="bonus_trigger1" effect="special_woot_itemspawn"/>
      <spawnItem item="weapon_woot_musketball_dunker" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger6" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_7" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="equal" value="7" />
    </if>
    <then>
      <spawnMagick magick="sundead" area="bonus_trigger1" immovable="false" />
      <spawneffect name="bonus_book_trigger5" area="bonus_trigger1" effect="special_woot_itemspawn"/>
      <spawnItem item="weapon_woot_water_bottle" area="bonus_trigger2" physicsEnabled="true" />
      <spawneffect name="bonus_item_trigger7" area="bonus_trigger2" effect="special_woot_itemspawn"/>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <trigger id="holes_countCheck_8" repeat="true" autorun="false">
    <if>
      <counter name="holes_closed_counter" compareMethod="greater" value="7" />
    </if>
    <then>
      <!-- TODO: Play cheer effects -->
      <spawneffect name="kill_triggertest" area="bonus_trigger1" effect="special_woot_area_damage"/>
      <damage factions="evil" ignoreshields="true" area="any" delay="0" >
        <damage attackproperty="damage" elements="physical"     amount="900" magnitude="1" />
      </damage>
      <executeTrigger trigger="hole_generic_close" />
    </then>
  </trigger>

  <!-- Hole & Lamp Scripts
  
        Note that when a hole's detector trigger is "disabled" (hatch closed), the killplane far below the map will take care of any
        potential enemies falling into the hole while it's closing.
        
        Note that if more than one unit fall into a trigger at the exact same time, only one of them will count towards the hole filling up.
        This is because it would take unreasonably many scripts to ask anything but "is there more than 0 units present" before killing
        all units in the trigger.
  -->

  <trigger id="hole_generic_open" repeat="true" autorun="false">
    <if />
    <then>
      <playSound id="hole_doors_open" cue="Additional/woot_trap_door_open" volume="0" />
      <stopSound id="hole_doors_open" delay="3" />
    </then>
  </trigger>

  <trigger id="hole_generic_close" repeat="true" autorun="false">
    <if />
    <then>
      <playSound id="hole_doors_close" cue="Additional/woot_trap_door_close" volume="0" />
      <stopSound id="hole_doors_close" delay="3" />
      <playSound volume="6" cue="Additionalmusic/woot_amb_big_cheers" delay="0.3" />
    </then>
  </trigger>

  <trigger id="hole_generic_fall_in" repeat="true" autorun="false">
    <if />
    <then>
      <playSound id="hole_cheer_sound" volume="3" cue="Additionalmusic/amb_woot_regular_cheers" delay="0.1" />
    </then>
  </trigger>


  <!-- Hole 1 ###################################################################################################################### Hole 1
  -->

  <!-- Hole Detectors	-->
  <trigger id="hole1_detector" repeat="true" autorun="true">
    <if>
      <factionPresent factions="evil,friendly,wizard" area="hole1_trigger" compareMethod="greater" nr="0" />
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      
      <!-- This trigger may only fire it the following units are NOT present -->
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="troll_war" />
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="troll_stone" />
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="troll_snow" />
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="troll_forest" />
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="boss_warlord" />
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="starspawn" />
      <present area="hole1_trigger" compareMethod="equal" nr="0" type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole1_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly normal crowd cheer -->
      <spawneffect name="kill_trigger1" area="hole1effect" effect="Gore_Gib_Regular_Large"/>    
      <!-- Add one to the hole counter -->
      <counter name="hole1_counter" action="inc" value="1" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole1_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole1_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <trigger id="hole1_detector_heavy" repeat="true" autorun="true">
    <if>
      <!-- Fire this trigger only if one of the following units are present -->
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="troll_war" />
    </if>
    <if>
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="troll_stone" />
    </if>
    <if>
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="troll_snow" />
    </if>
    <if>
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="troll_forest" />
    </if>
    <if>
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="boss_warlord" />
    </if>
    <if>
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="starspawn" />
    </if>
    <if>
      <counter name="hole1_detector_active" compareMethod="equal" value="1" />
      <present area="hole1_trigger" compareMethod="greater" nr="0"            type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole1_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly awesomely frantic special crowd cheer -->

      <!-- Add one to the hole counter -->
      <counter name="hole1_counter" action="inc" value="8" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole1_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole1_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <!-- Check if closed, and if so, close the hatch and start opening sequence -->
  <trigger id="hole1_checkFull" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="7" />
    </if>
    <then>
      <!-- Close hatch and disable its detector trigger script -->
      <playAnimation name="holes/hole1_doors" start="0" end="1" speed="1" />
      <counter name="hole1_detector_active" action="set" value="0" />

      <!-- Add 1 to the closed holes counter, used by the bonus spawner -->
      <counter name="holes_closed_counter" action="inc" value="1" />
      
      <!-- Handle closing bonus -->
      <executeTrigger trigger="holes_shared_spawn_bonus" />

      <!-- Set counter to 8 as it should be, just in case -->
      <counter name="hole1_counter" action="set" value="8" />

      <!-- Sequentially turn off all lights and finally open the hatch again -->
      <counter name="hole1_counter" action="dec" value="1"  delay="3" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="3" />
      <counter name="hole1_counter" action="dec" value="1"  delay="6" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="6" />
      <counter name="hole1_counter" action="dec" value="1"  delay="9" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="9" />
      <counter name="hole1_counter" action="dec" value="1"  delay="12" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="12" />
      <counter name="hole1_counter" action="dec" value="1"  delay="15" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="15" />
      <counter name="hole1_counter" action="dec" value="1"  delay="18" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="18" />
      <counter name="hole1_counter" action="dec" value="1"  delay="21" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="21" />
      <counter name="hole1_counter" action="dec" value="1"  delay="24" />
      <executeTrigger trigger="hole1_lampAll_checkOff"      delay="24" />

      <counter name="hole1_counter" action="set" value="0"  delay="24" />

      <!-- Open hatch and activate its detector trigger script -->
      <playAnimation name="holes/hole1_doors" start="1" end="2" speed="1" delay="24" />
      <executeTrigger trigger="hole_generic_open" delay="24" />
      <counter name="hole1_detector_active" action="set" value="1" delay="24" />
    </then>
  </trigger>

  <!-- Lamps -->
  <trigger id="hole1_lampAll_checkOn" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole1_lamp1_checkOn" />
      <executeTrigger trigger="hole1_lamp2_checkOn" />
      <executeTrigger trigger="hole1_lamp3_checkOn" />
      <executeTrigger trigger="hole1_lamp4_checkOn" />
      <executeTrigger trigger="hole1_lamp5_checkOn" />
      <executeTrigger trigger="hole1_lamp6_checkOn" />
      <executeTrigger trigger="hole1_lamp7_checkOn" />
      <executeTrigger trigger="hole1_lamp8_checkOn" />
    </then>
  </trigger>

  <trigger id="hole1_lampAll_checkOff" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole1_lamp1_checkOff" />
      <executeTrigger trigger="hole1_lamp2_checkOff" />
      <executeTrigger trigger="hole1_lamp3_checkOff" />
      <executeTrigger trigger="hole1_lamp4_checkOff" />
      <executeTrigger trigger="hole1_lamp5_checkOff" />
      <executeTrigger trigger="hole1_lamp6_checkOff" />
      <executeTrigger trigger="hole1_lamp7_checkOff" />
      <executeTrigger trigger="hole1_lamp8_checkOff" />
    </then>
  </trigger>

  <trigger id="hole1_lamp1_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="0" />
      <counter name="hole1_lamp1_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind1" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp1_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp1_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="0" />
      <counter name="hole1_lamp1_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind1" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp1_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp2_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="1" />
      <counter name="hole1_lamp2_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind2" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp2_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp2_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="1" />
      <counter name="hole1_lamp2_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind2" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp2_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp3_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="2" />
      <counter name="hole1_lamp3_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind3" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp3_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp3_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="2" />
      <counter name="hole1_lamp3_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind3" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp3_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp4_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="3" />
      <counter name="hole1_lamp4_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind4" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp4_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp4_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="3" />
      <counter name="hole1_lamp4_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind4" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp4_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp5_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="4" />
      <counter name="hole1_lamp5_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind5" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp5_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp5_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="4" />
      <counter name="hole1_lamp5_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind5" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp5_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp6_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="5" />
      <counter name="hole1_lamp6_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind6" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp6_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp6_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="5" />
      <counter name="hole1_lamp6_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind6" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp6_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp7_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="6" />
      <counter name="hole1_lamp7_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind7" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp7_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp7_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="6" />
      <counter name="hole1_lamp7_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind7" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp7_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole1_lamp8_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" value="7" />
      <counter name="hole1_lamp8_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind8" start="0" end="0.5" speed="1" />
      <counter name="hole1_lamp8_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole1_lamp8_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole1_counter" compareMethod="greater" invert="true" value="7" />
      <counter name="hole1_lamp8_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole1_indicators/hole1_ind8" start="0.5" end="0" speed="-1" />
      <counter name="hole1_lamp8_state" action="set" value="0" />
    </then>
  </trigger>

  <!-- Hole 2 ###################################################################################################################### Hole 2
  -->

  <!-- Hole Detectors	-->
  <trigger id="hole2_detector" repeat="true" autorun="true">
    <if>
      <factionPresent factions="evil,friendly,wizard" area="hole2_trigger" compareMethod="greater" nr="0" />
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />

      <!-- This trigger may only fire it the following units are NOT present -->
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="troll_war" />
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="troll_stone" />
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="troll_snow" />
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="troll_forest" />
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="boss_warlord" />
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="starspawn" />
      <present area="hole2_trigger" compareMethod="equal" nr="0" type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole2_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly normal crowd cheer -->
      <spawneffect name="kill_trigger2" area="hole2effect" effect="Gore_Gib_Regular_Large"/>
      <!-- Add one to the hole counter -->
      <counter name="hole2_counter" action="inc" value="1" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole2_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole2_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <trigger id="hole2_detector_heavy" repeat="true" autorun="true">
    <if>
      <!-- Fire this trigger only if one of the following units are present -->
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="troll_war" />
    </if>
    <if>
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="troll_stone" />
    </if>
    <if>
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="troll_snow" />
    </if>
    <if>
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="troll_forest" />
    </if>
    <if>
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="boss_warlord" />
    </if>
    <if>
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="starspawn" />
    </if>
    <if>
      <counter name="hole2_detector_active" compareMethod="equal" value="1" />
      <present area="hole2_trigger" compareMethod="greater" nr="0"            type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole2_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly awesomely frantic special crowd cheer -->

      <!-- Add one to the hole counter -->
      <counter name="hole2_counter" action="inc" value="8" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole2_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole2_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <!-- Check if closed, and if so, close the hatch and start opening sequence -->
  <trigger id="hole2_checkFull" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="7" />
    </if>
    <then>
      <!-- Close hatch and disable its detector trigger script -->
      <playAnimation name="holes/hole2_doors" start="0" end="1" speed="1" />
      <counter name="hole2_detector_active" action="set" value="0" />

      <!-- Add 1 to the closed holes counter, used by the bonus spawner -->
      <counter name="holes_closed_counter" action="inc" value="1" />

      <!-- Handle closing bonus -->
      <executeTrigger trigger="holes_shared_spawn_bonus" />

      <!-- Set counter to 8 as it should be, just in case -->
      <counter name="hole2_counter" action="set" value="8" />

      <!-- Sequentially turn off all lights and finally open the hatch again -->
      <counter name="hole2_counter" action="dec" value="1"  delay="3" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="3" />
      <counter name="hole2_counter" action="dec" value="1"  delay="6" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="6" />
      <counter name="hole2_counter" action="dec" value="1"  delay="9" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="9" />
      <counter name="hole2_counter" action="dec" value="1"  delay="12" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="12" />
      <counter name="hole2_counter" action="dec" value="1"  delay="15" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="15" />
      <counter name="hole2_counter" action="dec" value="1"  delay="18" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="18" />
      <counter name="hole2_counter" action="dec" value="1"  delay="21" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="21" />
      <counter name="hole2_counter" action="dec" value="1"  delay="24" />
      <executeTrigger trigger="hole2_lampAll_checkOff"      delay="24" />

      <counter name="hole2_counter" action="set" value="0"  delay="24" />

      <!-- Open hatch and activate its detector trigger script -->
      <playAnimation name="holes/hole2_doors" start="1" end="2" speed="1" delay="24" />
      <executeTrigger trigger="hole_generic_open" delay="24" />
      <counter name="hole2_detector_active" action="set" value="1" delay="24" />
    </then>
  </trigger>

  <!-- Lamps -->
  <trigger id="hole2_lampAll_checkOn" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole2_lamp1_checkOn" />
      <executeTrigger trigger="hole2_lamp2_checkOn" />
      <executeTrigger trigger="hole2_lamp3_checkOn" />
      <executeTrigger trigger="hole2_lamp4_checkOn" />
      <executeTrigger trigger="hole2_lamp5_checkOn" />
      <executeTrigger trigger="hole2_lamp6_checkOn" />
      <executeTrigger trigger="hole2_lamp7_checkOn" />
      <executeTrigger trigger="hole2_lamp8_checkOn" />
    </then>
  </trigger>

  <trigger id="hole2_lampAll_checkOff" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole2_lamp1_checkOff" />
      <executeTrigger trigger="hole2_lamp2_checkOff" />
      <executeTrigger trigger="hole2_lamp3_checkOff" />
      <executeTrigger trigger="hole2_lamp4_checkOff" />
      <executeTrigger trigger="hole2_lamp5_checkOff" />
      <executeTrigger trigger="hole2_lamp6_checkOff" />
      <executeTrigger trigger="hole2_lamp7_checkOff" />
      <executeTrigger trigger="hole2_lamp8_checkOff" />
    </then>
  </trigger>

  <trigger id="hole2_lamp1_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="0" />
      <counter name="hole2_lamp1_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind1" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp1_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp1_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="0" />
      <counter name="hole2_lamp1_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind1" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp1_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp2_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="1" />
      <counter name="hole2_lamp2_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind2" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp2_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp2_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="1" />
      <counter name="hole2_lamp2_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind2" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp2_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp3_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="2" />
      <counter name="hole2_lamp3_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind3" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp3_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp3_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="2" />
      <counter name="hole2_lamp3_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind3" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp3_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp4_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="3" />
      <counter name="hole2_lamp4_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind4" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp4_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp4_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="3" />
      <counter name="hole2_lamp4_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind4" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp4_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp5_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="4" />
      <counter name="hole2_lamp5_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind5" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp5_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp5_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="4" />
      <counter name="hole2_lamp5_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind5" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp5_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp6_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="5" />
      <counter name="hole2_lamp6_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind6" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp6_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp6_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="5" />
      <counter name="hole2_lamp6_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind6" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp6_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp7_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="6" />
      <counter name="hole2_lamp7_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind7" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp7_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp7_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="6" />
      <counter name="hole2_lamp7_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind7" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp7_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole2_lamp8_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" value="7" />
      <counter name="hole2_lamp8_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind8" start="0" end="0.5" speed="1" />
      <counter name="hole2_lamp8_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole2_lamp8_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole2_counter" compareMethod="greater" invert="true" value="7" />
      <counter name="hole2_lamp8_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole2_indicators/hole2_ind8" start="0.5" end="0" speed="-1" />
      <counter name="hole2_lamp8_state" action="set" value="0" />
    </then>
  </trigger>

  <!-- Hole 3 ###################################################################################################################### Hole 3
  -->

  <!-- Hole Detectors	-->
  <trigger id="hole3_detector" repeat="true" autorun="true">
    <if>
      <factionPresent factions="evil,friendly,wizard" area="hole3_trigger" compareMethod="greater" nr="0" />
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />

      <!-- This trigger may only fire it the following units are NOT present -->
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="troll_war" />
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="troll_stone" />
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="troll_snow" />
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="troll_forest" />
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="boss_warlord" />
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="starspawn" />
      <present area="hole3_trigger" compareMethod="equal" nr="0" type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole3_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly normal crowd cheer -->
      <spawneffect name="kill_trigger3" area="hole4effect" effect="Gore_Gib_Regular_Large"/>
      <!-- Add one to the hole counter -->
      <counter name="hole3_counter" action="inc" value="1" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole3_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole3_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <trigger id="hole3_detector_heavy" repeat="true" autorun="true">
    <if>
      <!-- Fire this trigger only if one of the following units are present -->
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="troll_war" />
    </if>
    <if>
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="troll_stone" />
    </if>
    <if>
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="troll_snow" />
    </if>
    <if>
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="troll_forest" />
    </if>
    <if>
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="boss_warlord" />
    </if>
    <if>
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="starspawn" />
    </if>
    <if>
      <counter name="hole3_detector_active" compareMethod="equal" value="1" />
      <present area="hole3_trigger" compareMethod="greater" nr="0"            type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole3_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly awesomely frantic special crowd cheer -->

      <!-- Add one to the hole counter -->
      <counter name="hole3_counter" action="inc" value="8" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole3_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole3_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <!-- Check if closed, and if so, close the hatch and start opening sequence -->
  <trigger id="hole3_checkFull" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="7" />
    </if>
    <then>
      <!-- Close hatch and disable its detector trigger script -->
      <playAnimation name="holes/hole3_doors" start="0" end="1" speed="1" />
      <counter name="hole3_detector_active" action="set" value="0" />

      <!-- Add 1 to the closed holes counter, used by the bonus spawner -->
      <counter name="holes_closed_counter" action="inc" value="1" />

      <!-- Handle closing bonus -->
      <executeTrigger trigger="holes_shared_spawn_bonus" />

      <!-- Set counter to 8 as it should be, just in case -->
      <counter name="hole3_counter" action="set" value="8" />

      <!-- Sequentially turn off all lights and finally open the hatch again -->
      <counter name="hole3_counter" action="dec" value="1"  delay="3" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="3" />
      <counter name="hole3_counter" action="dec" value="1"  delay="6" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="6" />
      <counter name="hole3_counter" action="dec" value="1"  delay="9" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="9" />
      <counter name="hole3_counter" action="dec" value="1"  delay="12" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="12" />
      <counter name="hole3_counter" action="dec" value="1"  delay="15" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="15" />
      <counter name="hole3_counter" action="dec" value="1"  delay="18" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="18" />
      <counter name="hole3_counter" action="dec" value="1"  delay="21" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="21" />
      <counter name="hole3_counter" action="dec" value="1"  delay="24" />
      <executeTrigger trigger="hole3_lampAll_checkOff"      delay="24" />

      <counter name="hole3_counter" action="set" value="0"  delay="24" />

      <!-- Open hatch and activate its detector trigger script -->
      <playAnimation name="holes/hole3_doors" start="1" end="2" speed="1" delay="24" />
      <executeTrigger trigger="hole_generic_open" delay="24" />
      <counter name="hole3_detector_active" action="set" value="1" delay="24" />
    </then>
  </trigger>

  <!-- Lamps -->
  <trigger id="hole3_lampAll_checkOn" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole3_lamp1_checkOn" />
      <executeTrigger trigger="hole3_lamp2_checkOn" />
      <executeTrigger trigger="hole3_lamp3_checkOn" />
      <executeTrigger trigger="hole3_lamp4_checkOn" />
      <executeTrigger trigger="hole3_lamp5_checkOn" />
      <executeTrigger trigger="hole3_lamp6_checkOn" />
      <executeTrigger trigger="hole3_lamp7_checkOn" />
      <executeTrigger trigger="hole3_lamp8_checkOn" />
    </then>
  </trigger>

  <trigger id="hole3_lampAll_checkOff" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole3_lamp1_checkOff" />
      <executeTrigger trigger="hole3_lamp2_checkOff" />
      <executeTrigger trigger="hole3_lamp3_checkOff" />
      <executeTrigger trigger="hole3_lamp4_checkOff" />
      <executeTrigger trigger="hole3_lamp5_checkOff" />
      <executeTrigger trigger="hole3_lamp6_checkOff" />
      <executeTrigger trigger="hole3_lamp7_checkOff" />
      <executeTrigger trigger="hole3_lamp8_checkOff" />
    </then>
  </trigger>

  <trigger id="hole3_lamp1_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="0" />
      <counter name="hole3_lamp1_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind1" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp1_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp1_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="0" />
      <counter name="hole3_lamp1_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind1" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp1_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp2_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="1" />
      <counter name="hole3_lamp2_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind2" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp2_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp2_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="1" />
      <counter name="hole3_lamp2_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind2" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp2_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp3_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="2" />
      <counter name="hole3_lamp3_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind3" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp3_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp3_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="2" />
      <counter name="hole3_lamp3_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind3" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp3_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp4_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="3" />
      <counter name="hole3_lamp4_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind4" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp4_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp4_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="3" />
      <counter name="hole3_lamp4_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind4" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp4_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp5_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="4" />
      <counter name="hole3_lamp5_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind5" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp5_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp5_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="4" />
      <counter name="hole3_lamp5_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind5" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp5_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp6_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="5" />
      <counter name="hole3_lamp6_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind6" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp6_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp6_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="5" />
      <counter name="hole3_lamp6_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind6" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp6_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp7_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="6" />
      <counter name="hole3_lamp7_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind7" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp7_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp7_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="6" />
      <counter name="hole3_lamp7_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind7" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp7_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole3_lamp8_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" value="7" />
      <counter name="hole3_lamp8_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind8" start="0" end="0.5" speed="1" />
      <counter name="hole3_lamp8_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole3_lamp8_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole3_counter" compareMethod="greater" invert="true" value="7" />
      <counter name="hole3_lamp8_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole3_indicators/hole3_ind8" start="0.5" end="0" speed="-1" />
      <counter name="hole3_lamp8_state" action="set" value="0" />
    </then>
  </trigger>

  <!-- Hole 4 ###################################################################################################################### Hole 4
  -->

  <!-- Hole Detectors	-->
  <trigger id="hole4_detector" repeat="true" autorun="true">
    <if>
      <factionPresent factions="evil,friendly,wizard" area="hole4_trigger" compareMethod="greater" nr="0" />
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />

      <!-- This trigger may only fire it the following units are NOT present -->
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="troll_war" />
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="troll_stone" />
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="troll_snow" />
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="troll_forest" />
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="boss_warlord" />
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="starspawn" />
      <present area="hole4_trigger" compareMethod="equal" nr="0" type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole4_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly normal crowd cheer -->
      <spawneffect name="kill_trigger4" area="hole3effect" effect="Gore_Gib_Regular_Large"/>
      <!-- Add one to the hole counter -->
      <counter name="hole4_counter" action="inc" value="1" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole4_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole4_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <trigger id="hole4_detector_heavy" repeat="true" autorun="true">
    <if>
      <!-- Fire this trigger only if one of the following units are present -->
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="troll_war" />
    </if>
    <if>
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="troll_stone" />
    </if>
    <if>
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="troll_snow" />
    </if>
    <if>
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="troll_forest" />
    </if>
    <if>
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="boss_warlord" />
    </if>
    <if>
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="starspawn" />
    </if>
    <if>
      <counter name="hole4_detector_active" compareMethod="equal" value="1" />
      <present area="hole4_trigger" compareMethod="greater" nr="0"            type="beholder_malign" />
    </if>
    <then>
      <!-- Overkill all units present in the trigger area -->
      <overkill factions="evil,friendly" area="hole4_trigger" delay="0" />

      <!-- TODO: Add special effect from hole and possibly awesomely frantic special crowd cheer -->

      <!-- Add one to the hole counter -->
      <counter name="hole4_counter" action="inc" value="8" />

      <!-- Call lamp scripts that turn on lights depending on amount of enemies that has fallen into it -->
      <executeTrigger trigger="hole4_lampAll_checkOn" />

      <!-- Check to see if the hole is now full -->
      <executeTrigger trigger="hole4_checkFull" />

      <!-- Play generic effects when unit falls in -->
      <executeTrigger trigger="hole_generic_fall_in" />
    </then>
  </trigger>

  <!-- Check if closed, and if so, close the hatch and start opening sequence -->
  <trigger id="hole4_checkFull" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="7" />
    </if>
    <then>
      <!-- Close hatch and disable its detector trigger script -->
      <playAnimation name="holes/hole4_doors" start="0" end="1" speed="1" />
      <counter name="hole4_detector_active" action="set" value="0" />

      <!-- Add 1 to the closed holes counter, used by the bonus spawner -->
      <counter name="holes_closed_counter" action="inc" value="1" />

      <!-- Handle closing bonus -->
      <executeTrigger trigger="holes_shared_spawn_bonus" />

      <!-- Set counter to 8 as it should be, just in case -->
      <counter name="hole4_counter" action="set" value="8" />

      <!-- Sequentially turn off all lights and finally open the hatch again -->
      <counter name="hole4_counter" action="dec" value="1"  delay="3" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="3" />
      <counter name="hole4_counter" action="dec" value="1"  delay="6" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="6" />
      <counter name="hole4_counter" action="dec" value="1"  delay="9" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="9" />
      <counter name="hole4_counter" action="dec" value="1"  delay="12" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="12" />
      <counter name="hole4_counter" action="dec" value="1"  delay="15" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="15" />
      <counter name="hole4_counter" action="dec" value="1"  delay="18" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="18" />
      <counter name="hole4_counter" action="dec" value="1"  delay="21" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="21" />
      <counter name="hole4_counter" action="dec" value="1"  delay="24" />
      <executeTrigger trigger="hole4_lampAll_checkOff"      delay="24" />

      <counter name="hole4_counter" action="set" value="0"  delay="24" />

      <!-- Open hatch and activate its detector trigger script -->
      <playAnimation name="holes/hole4_doors" start="1" end="2" speed="1" delay="24" />
      <executeTrigger trigger="hole_generic_open" delay="24" />
      <counter name="hole4_detector_active" action="set" value="1" delay="24" />
    </then>
  </trigger>

  <!-- Lamps -->
  <trigger id="hole4_lampAll_checkOn" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole4_lamp1_checkOn" />
      <executeTrigger trigger="hole4_lamp2_checkOn" />
      <executeTrigger trigger="hole4_lamp3_checkOn" />
      <executeTrigger trigger="hole4_lamp4_checkOn" />
      <executeTrigger trigger="hole4_lamp5_checkOn" />
      <executeTrigger trigger="hole4_lamp6_checkOn" />
      <executeTrigger trigger="hole4_lamp7_checkOn" />
      <executeTrigger trigger="hole4_lamp8_checkOn" />
    </then>
  </trigger>

  <trigger id="hole4_lampAll_checkOff" repeat="true" autorun="false">
    <if />
    <then>
      <executeTrigger trigger="hole4_lamp1_checkOff" />
      <executeTrigger trigger="hole4_lamp2_checkOff" />
      <executeTrigger trigger="hole4_lamp3_checkOff" />
      <executeTrigger trigger="hole4_lamp4_checkOff" />
      <executeTrigger trigger="hole4_lamp5_checkOff" />
      <executeTrigger trigger="hole4_lamp6_checkOff" />
      <executeTrigger trigger="hole4_lamp7_checkOff" />
      <executeTrigger trigger="hole4_lamp8_checkOff" />
    </then>
  </trigger>

  <trigger id="hole4_lamp1_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="0" />
      <counter name="hole4_lamp1_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind1" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp1_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp1_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="0" />
      <counter name="hole4_lamp1_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind1" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp1_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp2_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="1" />
      <counter name="hole4_lamp2_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind2" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp2_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp2_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="1" />
      <counter name="hole4_lamp2_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind2" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp2_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp3_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="2" />
      <counter name="hole4_lamp3_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind3" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp3_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp3_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="2" />
      <counter name="hole4_lamp3_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind3" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp3_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp4_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="3" />
      <counter name="hole4_lamp4_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind4" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp4_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp4_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="3" />
      <counter name="hole4_lamp4_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind4" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp4_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp5_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="4" />
      <counter name="hole4_lamp5_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind5" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp5_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp5_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="4" />
      <counter name="hole4_lamp5_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind5" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp5_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp6_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="5" />
      <counter name="hole4_lamp6_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind6" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp6_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp6_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="5" />
      <counter name="hole4_lamp6_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind6" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp6_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp7_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="6" />
      <counter name="hole4_lamp7_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind7" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp7_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp7_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="6" />
      <counter name="hole4_lamp7_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind7" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp7_state" action="set" value="0" />
    </then>
  </trigger>

  <trigger id="hole4_lamp8_checkOn" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" value="7" />
      <counter name="hole4_lamp8_state" compareMethod="equal" value="0" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind8" start="0" end="0.5" speed="1" />
      <counter name="hole4_lamp8_state" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="hole4_lamp8_checkOff" repeat="true" autorun="false">
    <if>
      <counter name="hole4_counter" compareMethod="greater" invert="true" value="7" />
      <counter name="hole4_lamp8_state" compareMethod="equal" value="1" />
    </if>
    <then>
      <playAnimation name="holes/hole4_indicators/hole4_ind8" start="0.5" end="0" speed="-1" />
      <counter name="hole4_lamp8_state" action="set" value="0" />
    </then>
  </trigger>

  <!--
        #####################################################################################################################################
            Confetti of Misfortune scripts
            These detect if a player dies and allows for special effects and cheers upon that event.
            Run "confettiOfMisfortune_cycle" first to enable.
            
                  <executeTrigger trigger="confettiOfMisfortune_cycle" delay="0.5" />
                  
            Use the following line to trigger confetti of misfortune at other times...
            
                  <counter name="confettiOfMisfortune_aliveCount" action="set" value="5" />

        #####################################################################################################################################
  -->

  <trigger id="confettiOfMisfortune_cycle" repeat="true" autorun="false">
    <if></if>
    <then>
      <!-- Check if alive players count is less than last cycle -->
      <executeTrigger trigger="confettiOfMisfortune_checkDeathEvent" delay="0" />

      <!-- Store the count of alive players, used at the beginning of next cycle -->
      <counter name="confettiOfMisfortune_aliveCount" action="set" value="0" delay="0.01"/>
      <executeTrigger trigger="confettiOfMisfortune_storeAliveCount1" delay="0.02" />
      <executeTrigger trigger="confettiOfMisfortune_storeAliveCount2" delay="0.02" />
      <executeTrigger trigger="confettiOfMisfortune_storeAliveCount3" delay="0.02" />
      <executeTrigger trigger="confettiOfMisfortune_storeAliveCount4" delay="0.02" />

      <!-- Call self after a short delay to continue the cycle -->
      <executeTrigger trigger="confettiOfMisfortune_cycle" delay="0.3" />
    </then>
  </trigger>

  <trigger id="confettiOfMisfortune_checkDeathEvent" repeat="true" autorun="false">
    <if>
      <!-- Are there less players alive this cycle than the last? -->
      <counter name="confettiOfMisfortune_aliveCount" compareMethod="equal" value="1" />
      <present type="wizard" area="any" compareMethod="less" nr="1" />
    </if>
    <if>
      <counter name="confettiOfMisfortune_aliveCount" compareMethod="equal" value="2" />
      <present type="wizard" area="any" compareMethod="less" nr="2" />
    </if>
    <if>
      <counter name="confettiOfMisfortune_aliveCount" compareMethod="equal" value="3" />
      <present type="wizard" area="any" compareMethod="less" nr="3" />
    </if>
    <if>
      <counter name="confettiOfMisfortune_aliveCount" compareMethod="equal" value="4" />
      <present type="wizard" area="any" compareMethod="less" nr="4" />
    </if>
    <then>
      <!-- TODO: Add cheers and special effects after this line............................................................. -->

      <playSound volume="2" cue="Additionalmusic/woot_amb_big_cheers" />
    </then>
  </trigger>

  <trigger id="confettiOfMisfortune_storeAliveCount1" repeat="true" autorun="false">
    <if>
      <present type="wizard" area="any" compareMethod="equal" nr="1" />
    </if>
    <then>
      <counter name="confettiOfMisfortune_aliveCount" action="set" value="1" />
    </then>
  </trigger>

  <trigger id="confettiOfMisfortune_storeAliveCount2" repeat="true" autorun="false">
    <if>
      <present type="wizard" area="any" compareMethod="equal" nr="2" />
    </if>
    <then>
      <counter name="confettiOfMisfortune_aliveCount" action="set" value="2" />
    </then>
  </trigger>

  <trigger id="confettiOfMisfortune_storeAliveCount3" repeat="true" autorun="false">
    <if>
      <present type="wizard" area="any" compareMethod="equal" nr="3" />
    </if>
    <then>
      <counter name="confettiOfMisfortune_aliveCount" action="set" value="3" />
    </then>
  </trigger>

  <trigger id="confettiOfMisfortune_storeAliveCount4" repeat="true" autorun="false">
    <if>
      <present type="wizard" area="any" compareMethod="equal" nr="4" />
    </if>
    <then>
      <counter name="confettiOfMisfortune_aliveCount" action="set" value="4" />
    </then>
  </trigger>

  <!--
      ######################################################################################################################################################
      ## ##### ####    ##### ### #####   ######    #########################################################################################################
      ## ##### ######## #### ### #### ### #### #############################################################################################################
      ## ## ## ####     #### ## #####    ######   ##########################################################################################################
      ## ## ## #### ### #### # ###### ############ #########################################################################################################
      ###  #  ######    ####  ########    ####    ##########################################################################################################
      ######################################################################################################################################################
  
      Waves
  -->

  <trigger id="generic_new_wave_effects" repeat="true" autorun="false">
    <if />
    <then>
      <playSound id="new_wave_cheers" volume="2" cue="Additionalmusic/amb_woot_regular_cheers" delay="1" />
    </then>
  </trigger>

  <!--  WAVE 1
        Notes:    Imps
                  Mobs (Imps) only come from one direction here, in a steady stream.
                  They are many, but extremely easy. Teach player pushing.
        -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="imp" nr="6" />
      <spawn type="imp" nr="6" delay="4" />
      <spawn type="imp" nr="6" delay="6" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
  </wave>

  <!--  WAVE 2
        Notes:    Imps, GoblinMiners
                  Mobs come from two different entrances that are next to each other
        -->
  <wave>
    <!--<playAnimation name="grate_anim" loop="false" children="true" speed="-1" />-->
    <waveActions area="east" delay="0">
      <spawn type="imp" nr="6" />
      <spawn type="goblin_miner" nr="3" />
      
      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="south" delay="5">
      <spawn type="imp" nr="6" />
      <spawn type="goblin_miner" nr="3" />
    </waveActions>
  </wave>

  <!--  WAVE 3
        Notes:    Spiders, GoblinRogueArchers
                  Monsters come in from different directions. Tricky. Also, ranged (arch firing) support.
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="spider_forest" nr="1" delay="0" />
      <spawn type="spider_forest" nr="1" delay="1" />
      <spawn type="spider_forest" nr="1" delay="2" />
      <spawn type="spider_forest" nr="1" delay="3" />
      <spawn type="goblin_rogue_archer" nr="1" forcenavmesh="true" delay="5" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="south" delay="0">
      <spawn type="spider_forest" nr="1" delay="0" />
      <spawn type="spider_forest" nr="1" delay="1" />
      <spawn type="spider_forest" nr="1" delay="2" />
      <spawn type="spider_forest" nr="1" delay="3" />
      <spawn type="goblin_rogue_archer" nr="1" forcenavmesh="true" delay="5" />
    </waveActions>
  </wave>

  <!--  WAVE 4
        Notes:    GoblinRogues, SpiderPoison
                  Monsters can come in from all directions. GoblinRogues can hump a player down holes.
                  Spiders are ranged support with inhibiting poison.
  -->
  <wave>
    <waveActions area="any" delay="0">
      <spawn type="goblin_rogue" nr="3" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="goblin_rogue" nr="3" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="goblin_rogue" nr="2" />
    </waveActions>

    <waveActions area="any" delay="3">
      <spawn type="goblin_warrior" nr="2" />
    </waveActions>

    <waveActions area="north" delay="1">
      <spawn type="spider_poison" nr="1" />
    </waveActions>
    <waveActions area="east" delay="1">
      <spawn type="spider_poison" nr="1" />
    </waveActions>
  </wave>

  <!--  WAVE 5    BOSS WAVE
        Notes:    SpiderForest, GoblinRogueArcher, GoblinWarriorCaptain, TrollForest
                  Spiders from 2 opposing directions (hole fodder). Archers as ranged support.
                  A TrollForest who will seem to be the main difficulty, but is easy to kite.
                  The GoblinWarriorCaptain, with freeze attack, will probably pose a greater threat
                    as it can take the player off guard.
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="goblin_rogue" nr="1" />
      <spawn type="goblin_rogue" nr="1" delay="1" />
      <spawn type="spider_forest" nr="1" delay="2" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="south" delay="0">
      <spawn type="goblin_rogue" nr="1" />
      <spawn type="goblin_rogue" nr="1" delay="1" />
      <spawn type="spider_forest" nr="1" delay="2" />
    </waveActions>

    <waveActions area="east" delay="6">
      <spawn type="goblin_rogue_archer" nr="2" forcenavmesh="true" />
      <spawn type="goblin_warrior_captain" nr="1" />
    </waveActions>

    <waveActions area="west" delay="10">
      <spawn type="goblin_rogue_archer" nr="2" forcenavmesh="true" />
      <spawn type="troll_forest" order="wander" targetarea="bonus_trigger" nr="1" />
    </waveActions>
  </wave>

  <!--  WAVE 6
        Notes:    GoblinWarrior, SpiderPoison, OrcRegular
                  Goblins as hole fodder
  -->
  <wave>
    <waveActions area="south" delay="0">
      <spawn type="goblin_warrior" nr="6" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="west" delay="4">
      <spawn type="goblin_warrior" nr="6" />
    </waveActions>

    <waveActions area="north" delay="5">
      <spawn type="spider_poison" nr="1" />
      <spawn type="orc_regular" nr="1" />
    </waveActions>

    <waveActions area="east" delay="5">
      <spawn type="spider_poison" nr="1" />
      <spawn type="orc_regular" nr="1" />
    </waveActions>
  </wave>

  <!--  WAVE 7
        Notes:    GoblinWarriorArcher, OrcWarrior, OrcWarriorCaptain
                  Goblins from all sides as ranged support, a few heavy orcs from any direction
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="goblin_warrior_archer" nr="2" forcenavmesh="true" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="east" delay="4">
      <spawn type="goblin_warrior_archer" nr="2" forcenavmesh="true" />
    </waveActions>
    <waveActions area="south" delay="4">
      <spawn type="goblin_warrior_archer" nr="2" forcenavmesh="true" />
    </waveActions>
    <waveActions area="west" delay="4">
      <spawn type="goblin_warrior_archer" nr="2" forcenavmesh="true" />
    </waveActions>

    <waveActions area="any" delay="0">
      <spawn type="orc_warrior" nr="2" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="orc_warrior" nr="2" />
    </waveActions>
    <waveActions area="any" delay="1">
      <spawn type="orc_captain" nr="1" />
    </waveActions>
  </wave>

  <!--  WAVE 8
        Notes:    SpiderForest, SpiderPoison, BeastmanBrute
                  Spiders from everywhere, BeastmanBrutes in teams
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="spider_forest" nr="2" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="east" delay="0">
      <spawn type="spider_forest" nr="2" />
    </waveActions>
    <waveActions area="north" delay="2">
      <spawn type="spider_forest" nr="2" />
    </waveActions>
    <waveActions area="east" delay="2">
      <spawn type="spider_forest" nr="2" />
    </waveActions>

    <waveActions area="south" delay="8">
      <spawn type="spider_forest" nr="2" />
    </waveActions>
    <waveActions area="west" delay="8">
      <spawn type="spider_forest" nr="2" />
    </waveActions>
    <waveActions area="south" delay="10">
      <spawn type="spider_forest" nr="2" />
    </waveActions>
    <waveActions area="west" delay="10">
      <spawn type="spider_forest" nr="2" />
    </waveActions>
    
    <waveActions area="any" delay="10">
      <spawn type="beastman_brute" nr="2" />
      <spawn type="beastman_brute_earth" nr="1" />
    </waveActions>

    <waveActions area="any" delay="18">
      <spawn type="beastman_brute" nr="3" />
      <spawn type="beastman_brute_fire" nr="1" />
    </waveActions>
  </wave>

  <!--  WAVE 9
        Notes:    Imp, GoblinRogue, Beholder
                  A horde of Imps, a few Goblins and a few Beholders (the second of which will be protected by the hole fodder)
  -->
  <wave>
    <waveActions area="east" delay="0">
      <spawn type="imp" nr="3" delay="0" />
      <spawn type="imp" nr="1" delay="3" />
      <spawn type="goblin_rogue" nr="2" delay="3" />
      <spawn type="imp" nr="1" delay="6" />
      <spawn type="goblin_rogue" nr="3" delay="6" />
      <spawn type="imp" nr="1" delay="9" />
      <spawn type="goblin_rogue" nr="1" delay="9" />
      <spawn type="beholder_malign" nr="1" delay="9" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    
    <waveActions area="north" delay="0">
      <spawn type="imp" nr="3" delay="0" />
      <spawn type="imp" nr="1" delay="3" />
      <spawn type="goblin_rogue" nr="2" delay="3" />
      <spawn type="imp" nr="1" delay="6" />
      <spawn type="goblin_rogue" nr="3" delay="6" />
      <spawn type="imp" nr="1" delay="9" />
      <spawn type="goblin_rogue" nr="1" delay="9" />
      <spawn type="beholder_malign" nr="1" delay="9" />
    </waveActions>
  </wave>

  <!--  WAVE 10   BOSS WAVE
        Notes:    WOOTWarlock, OrcWarlord (Khan)
                  A bunch of Khan with a Druid as support
  -->
  <wave>
    <waveActions area="any" delay="4">
      <spawn type="druid" nr="1" forcenavmesh="true" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="0" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>

    <waveActions area="south" delay="0">
      <spawn type="boss_warlord" nr="1" />
      <spawn type="boss_warlord" nr="1" delay="4" />
    </waveActions>
    <waveActions area="east" delay="0">
      <spawn type="boss_warlord" nr="1" />
      <spawn type="boss_warlord" nr="1" delay="4" />
    </waveActions>
  </wave>

  <!--  WAVE 11   (from now on, we will try to overwhelm the player)
        Notes:    SpiderForest, Necromancer, GoblinBomber, OrcWarrior, TrollWar
                  SpiderForest as hole fodder from everywhere, Necromancer for support
                  GoblinBombers and OrcWarriors act as pushers, TrollWar as soaker
  -->
  <wave>
    <waveActions area="any" delay="0">
      <spawn type="necromancer" nr="1" forcenavmesh="true" delay="0" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>

    <waveActions area="any" delay="0">
      <spawn type="spider_forest" nr="3" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="spider_forest" nr="3" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="spider_forest" nr="3" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="spider_forest" nr="3" />
    </waveActions>
    <waveActions area="any" delay="0">
      <spawn type="spider_forest" nr="3" />
    </waveActions>

    <waveActions area="west" delay="1">
      <spawn type="orc_warrior" nr="3" />
      <spawn type="troll_war" order="wander" targetarea="bonus_trigger" nr="1" delay="5" />
    </waveActions>

    <waveActions area="any" delay="3">
      <spawn type="goblin_bomber" nr="3" />
    </waveActions>
    <waveActions area="any" delay="3">
      <spawn type="goblin_bomber" nr="3" />
    </waveActions>
  </wave>

  <!--  WAVE 12
        Notes:    DarksoulFrost, Daemonling, BeastmanRaider, TrollForest
                  Daemonling as hole fodder and pushers from 2 directions, DarksoulFrost as ranged/inhibitor
                  BeastmanRaiderWater as trip-up/pusher, TrollForest as generic soaker to kite
  -->
  <wave>
    <waveActions area="north" delay="6">
      <spawn type="skeleton_darksoul_frost" nr="3" />
    </waveActions>

    <waveActions area="south" delay="0">
      <spawn type="daemon_lesser" nr="8" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="west" delay="4">
      <spawn type="daemon_lesser" nr="8" />
    </waveActions>

    <waveActions area="any" delay="15">
      <spawn type="beastman_raider_water" nr="2" delay="0" />
      <spawn type="troll_forest" nr="1" order="wander" targetarea="bonus_trigger" delay="0" />
      <spawn type="troll_forest_hook" nr="1" order="wander" targetarea="bonus_trigger" delay="5" />
      <spawn type="troll_forest" nr="1" order="wander" targetarea="bonus_trigger" delay="10" />
    </waveActions>
  </wave>

  <!--  WAVE 13
        Notes:    Cultist, GhoulFlamer, DeepOne
                  GhoulFlamer as hole fodder
                  DeepOnes as hold fodder, Cultist for dangerous ranged support
  -->
  <wave>
    <waveActions area="any" delay="0">
      <spawn type="deep_one" nr="4" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>

    <waveActions area="north" delay="6">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="4" />
    </waveActions>
    <waveActions area="east" delay="12">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="4" />
    </waveActions>
    <waveActions area="south" delay="18">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="4" />
    </waveActions>
    <waveActions area="west" delay="18">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="4" />
    </waveActions>

    <waveActions area="any" delay="9">
      <spawn type="cultist" nr="1" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="5" />
    </waveActions>
  </wave>

  <!--  WAVE 14
        Notes:    Daemonlings, OrcCaptain, Troll
                  Daemonlings from all directions, OrcCaptains coming in from two directions, One Beholder with delay (trip-up)
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="daemon_lesser" nr="3" delay="0" />
      <spawn type="daemon_lesser" nr="3" delay="3" />
      <spawn type="daemon_lesser" nr="3" delay="6" />
      <spawn type="daemon_lesser" nr="3" delay="9" />
      <spawn type="daemon_lesser" nr="3" delay="12" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="east" delay="0">
      <spawn type="daemon_lesser" nr="3" delay="0" />
      <spawn type="daemon_lesser" nr="3" delay="3" />
      <spawn type="daemon_lesser" nr="3" delay="6" />
      <spawn type="daemon_lesser" nr="3" delay="9" />
      <spawn type="daemon_lesser" nr="3" delay="12" />
    </waveActions>
    <waveActions area="south" delay="0">
      <spawn type="daemon_lesser" nr="3" delay="0" />
      <spawn type="daemon_lesser" nr="3" delay="3" />
      <spawn type="daemon_lesser" nr="3" delay="6" />
      <spawn type="daemon_lesser" nr="3" delay="9" />
      <spawn type="daemon_lesser" nr="3" delay="12" />
    </waveActions>
    <waveActions area="west" delay="0">
      <spawn type="daemon_lesser" nr="3" delay="0" />
      <spawn type="daemon_lesser" nr="3" delay="3" />
      <spawn type="daemon_lesser" nr="3" delay="6" />
      <spawn type="daemon_lesser" nr="3" delay="9" />
      <spawn type="daemon_lesser" nr="3" delay="12" />
    </waveActions>

    <waveActions area="north" delay="10">
      <spawn type="orc_captain" nr="1" />
    </waveActions>
    <waveActions area="south" delay="10">
      <spawn type="orc_captain" nr="1" />
    </waveActions>

    <waveActions area="any" delay="15">
      <spawn type="troll_stone" nr="1" order="wander" targetarea="bonus_trigger" delay="0" />
      <spawn type="troll_stone" nr="1" order="wander" targetarea="bonus_trigger" delay="5" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="7" />
    </waveActions>
  </wave>

  <!--  WAVE 15   BOSS WAVE
        Notes:    GhoulFlamer, Starspawn, Daemonling
                  GhoulFlamer in squads trickling in (with a few Daemonlings), Starspawn as boss
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="2" delay="0" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="west" delay="8">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="2" delay="0" />
    </waveActions>
    <waveActions area="south" delay="16">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="3" delay="2" />
      <spawn type="daemon_lesser" nr="3" delay="0" />
    </waveActions>
    <waveActions area="east" delay="24">
      <spawn type="ghoul_flamer" order="wander" targetarea="bonus_trigger" nr="3" delay="2" />
      <spawn type="daemon_lesser" nr="6" delay="0" />
    </waveActions>

    <waveActions area="any" delay="8">
      <spawn type="starspawn" nr="1" />
      <spawn type="starspawn" nr="1" delay="10" />
    </waveActions>
    
    <waveActions area="any" delay="12">
      <spawn type="troll_stone" order="wander" targetarea="bonus_trigger" nr="1" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="5" />
    </waveActions>
  </wave>

  <!--  WAVE 16
        Notes:    GoblinShaman, Druid, Daemonling, TrollStone
                  A hole bunch of GoblinShamans and a Druid as trip-up, a very few Daemonlings as delayed trip-up
                  A TrollStone as soaker
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="goblin_shaman" nr="1" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="0" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="east" delay="0">
      <spawn type="goblin_shaman" nr="1" forcenavmesh="true" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="0" />
    </waveActions>
    <waveActions area="south" delay="0">
      <spawn type="goblin_shaman" nr="1" delay="0" />
      <spawn type="necromancer" nr="1" forcenavmesh="true" delay="0" />
    </waveActions>
    <waveActions area="west" delay="0">
      <spawn type="goblin_shaman" nr="1" delay="0" />
      <spawn type="druid" nr="1" forcenavmesh="true" delay="0" />
    </waveActions>

    <waveActions area="any" delay="10">
      <spawn type="daemon_lesser" nr="5" />
      <spawn type="troll_stone" order="wander" targetarea="bonus_trigger" nr="1" />
      <spawn type="troll_stone" order="wander" targetarea="bonus_trigger" nr="1" delay="5" />
    </waveActions>
  </wave>

  <!--  WAVE 17
        Notes:    DwarfWarrior, OrcBerserker
                  DwarfWarriors as hole fodder
  -->
  <wave>
    <waveActions area="any" delay="0">
      <spawn type="dwarf_warrior" nr="6" delay="0" />
      <spawn type="dwarf_warrior" nr="6" delay="4" />
      <spawn type="dwarf_mage" nr="1" delay="8" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>

    <waveActions area="any" delay="9">
      <spawn type="orc_berserk" nr="4" />
    </waveActions>
  </wave>

  <!--  WAVE 18
        Notes:    Daemonlings, TrollSnow
                  A stream of daemonlings from one direction, one TrollSnow from each other direction
  -->
  <wave>
    <waveActions area="south" delay="0">
      <spawn type="daemon_lesser" nr="2" delay="0" />
      <spawn type="daemon_lesser" nr="2" delay="2" />
      <spawn type="daemon_lesser" nr="2" delay="4" />
      <spawn type="daemon_lesser" nr="2" delay="6" />
      <spawn type="daemon_lesser" nr="2" delay="8" />
      <spawn type="daemon_lesser" nr="2" delay="10" />
      <spawn type="daemon_lesser" nr="2" delay="12" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>

    <waveActions area="north" delay="2">
      <spawn type="troll_snow" order="wander" targetarea="bonus_trigger" nr="1" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="10" />
    </waveActions>
    <waveActions area="east" delay="2">
      <spawn type="troll_snow" order="wander" targetarea="bonus_trigger" nr="1" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="10" />
    </waveActions>
    <waveActions area="west" delay="2">
      <spawn type="troll_snow" order="wander" targetarea="bonus_trigger" nr="1" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="10" />
    </waveActions>
  </wave>

  <!--  WAVE 19
        Notes:    DwarfWarrior, DwarfMage, StarSpawn, TrollWar
                  DwarfWarriors as hole fodder, DwarfMage as dangerous ranged support,
                  TrollWars as soakers and a StarSpawn as trip-up
  -->
  <wave>
    <waveActions area="north" delay="0">
      <spawn type="dwarf_warrior" nr="4" delay="0" />
      <spawn type="dwarf_mage" nr="1" delay="1" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="west" delay="0">
      <spawn type="dwarf_warrior" nr="4" delay="0" />
      <spawn type="dwarf_mage" nr="1" delay="1" />
    </waveActions>

    <waveActions area="any" delay="3">
      <spawn type="starspawn" nr="1" />
    </waveActions>
    <waveActions area="east" delay="5">
      <spawn type="troll_war_arbalest" order="wander" targetarea="bonus_trigger" forcenavmesh="true" nr="1" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="5" />
    </waveActions>
    <waveActions area="south" delay="7">
      <spawn type="troll_war_arbalest" order="wander" targetarea="bonus_trigger" forcenavmesh="true" nr="1" />
    </waveActions>
  </wave>

  <!--  WAVE 20   BOSS WAVE
        Notes:    SpiderForest, SpiderPoison, FireDrake, OrcWarlord, TrollWar
                  A slow build up with Spiders as hole fodder
                  OrcWarlords come in at the peak of the SpiderForest horde
                  Firedrakes join in at end as ranged support, followed by TrollWars
  -->
  <wave>
    <waveActions area="any" delay="0">
      <spawn type="spider_forest" nr="3" delay="0" />

      <executeTrigger trigger="generic_new_wave_effects" />
    </waveActions>
    <waveActions area="any" delay="7">
      <spawn type="spider_forest" nr="4" delay="0" />
    </waveActions>
    <waveActions area="any" delay="15">
      <spawn type="spider_forest" nr="3" delay="0" />
      <spawn type="spider_poison" nr="2" delay="0" />
    </waveActions>
    
    <waveActions area="any" delay="25">
      <spawn type="spider_forest" nr="2" delay="0" />
      <spawn type="spider_forest" nr="2" delay="0" />
      <spawn type="spider_forest" nr="6" delay="0" />
      <spawn type="druid" nr="1" forcenavmesh="true" delay="1" />
    </waveActions>
    <waveActions area="any" delay="31">
      <spawn type="spider_forest" nr="5" delay="0" />
      <spawn type="spider_forest" nr="5" delay="0" />
      <spawn type="spider_forest" nr="5" delay="0" />
    </waveActions>
    <waveActions area="any" delay="36">
      <spawn type="spider_forest" nr="4" delay="0" />
      <spawn type="spider_forest" nr="4" delay="0" />
      <spawn type="spider_forest" nr="9" delay="0" />
      <spawn type="treespirit" nr="2" delay="1" />
      <spawn type="druid" nr="1" forcenavmesh="true" delay="3" />
    </waveActions>

    <waveActions area="north" delay="42">
      <spawn type="troll_war" order="wander" targetarea="bonus_trigger" nr="1" delay="0" />
      <spawn type="goblin_shaman" nr="1" delay="0" />
    </waveActions>
    <waveActions area="east" delay="42">
      <spawn type="troll_war_hook" order="wander" targetarea="bonus_trigger" nr="1" delay="0" />
      <spawn type="goblin_shaman" nr="1" delay="0" />
    </waveActions>
    <waveActions area="south" delay="42">
      <spawn type="troll_war" order="wander" targetarea="bonus_trigger" nr="1" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="0" />
    </waveActions>
    <waveActions area="west" delay="42">
      <spawn type="troll_war_arbalest" order="wander" targetarea="bonus_trigger" nr="1" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="0" />
    </waveActions>

    <waveActions area="any" delay="49">
      <spawn type="boss_warlord" nr="1" delay="0" />
      <spawn type="boss_warlord" nr="1" delay="1" />
    </waveActions>
    <waveActions area="any" delay="52">
      <spawn type="boss_warlord" nr="1" delay="0" />
      <spawn type="boss_warlord" nr="1" delay="1" />
    </waveActions>
    
    <waveActions area="north" delay="55">
      <spawn type="firedrake" nr="1" delay="0" />
      <spawn type="daemon_lesser" nr="3" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="1" />
    </waveActions>
    <waveActions area="east" delay="55">
      <spawn type="firedrake" nr="1" delay="0" />
    </waveActions>
    <waveActions area="south" delay="55">
      <spawn type="firedrake" nr="1" delay="0" />
      <spawn type="woot_enraged_goblin_warlock" nr="1" delay="1" />
    </waveActions>
    <waveActions area="west" delay="55">
      <spawn type="firedrake" nr="1" delay="0" />
      <spawn type="necromancer" nr="1" forcenavmesh="true" delay="1" />
    </waveActions>
  </wave>
</Scene>
